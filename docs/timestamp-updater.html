<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°å¤©æ‰å·¥å…·åŒ…</title>
    <!-- æµè§ˆå™¨æ ‡ç­¾é¡µå›¾æ ‡ -->
    <link rel="icon" type="image/x-icon" href="favicon.ico?v=1">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico?v=1">
    <link rel="apple-touch-icon" href="cat.png">
    <!-- æ¡å½¢ç å’ŒäºŒç»´ç åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            gap: 20px;
        }

        .main-wrapper {
            display: flex;
            justify-content: center;
            width: 100%;
        }

        .sidebar {
            width: 200px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            padding: 20px;
            height: fit-content;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
        }

        .sidebar-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .menu-item {
            padding: 10px 12px;
            margin-bottom: 8px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 13px;
            color: #555;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .menu-item:hover {
            background: #f0f4ff;
            color: #667eea;
            transform: translateX(5px);
        }

        .menu-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 18px;
            background: #667eea;
            border-radius: 2px;
        }

        textarea {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            line-height: 1.6;
            resize: vertical;
            transition: border-color 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        #outputText {
            display: none;
        }

        .output-display {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            line-height: 1.6;
            background: #f9f9f9;
            overflow-x: auto;
            white-space: pre;
            word-wrap: normal;
        }

        .highlight-timestamp {
            background: linear-gradient(90deg, #ffd54f 0%, #ffb300 100%);
            color: #d84315;
            font-weight: bold;
            padding: 2px 4px;
            border-radius: 3px;
            box-shadow: 0 1px 3px rgba(255, 179, 0, 0.3);
        }

        .converter-section {
            background: #f0f4ff;
            border: 2px dashed #667eea;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .converter-title {
            font-size: 22px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 15px;
            text-align: center;
        }

        .converter-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .converter-box {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .converter-label {
            font-size: 14px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .converter-box input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            margin-bottom: 10px;
            font-family: 'Consolas', monospace;
            transition: border-color 0.3s;
        }

        .converter-box input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn-convert {
            width: 100%;
            padding: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 10px;
        }

        .btn-convert:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .converter-result {
            background: #f9f9f9;
            padding: 12px;
            border-radius: 6px;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            color: #555;
            min-height: 60px;
            display: none;
            flex-direction: column;
            justify-content: center;
            border: 1px solid #e0e0e0;
        }

        .converter-result.show {
            display: flex;
        }

        .converter-result.success {
            background: #e8f5e9;
            border-color: #4caf50;
            color: #2e7d32;
        }

        @media (max-width: 768px) {
            .converter-grid {
                grid-template-columns: 1fr;
            }
        }

        .converter-status {
            padding: 10px 15px;
            border-radius: 6px;
            font-size: 14px;
            margin-top: 10px;
            display: none;
        }

        .converter-status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .converter-status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .converter-status.show {
            display: block;
            animation: slideIn 0.3s ease;
        }

        .json-tools {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
            justify-content: flex-end;
        }

        .btn-tool {
            padding: 4px 8px;
            background: #f5f7fa;
            color: #667eea;
            border: 1px solid #667eea;
            border-radius: 3px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
            min-width: auto;
        }

        .btn-tool:hover {
            background: #667eea;
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(102, 126, 234, 0.3);
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }

        button {
            flex: 1;
            padding: 14px 24px;
            font-size: 15px;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .btn-update {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-update:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
        }

        .btn-copy {
            background: #4caf50;
            color: white;
        }

        .btn-copy:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(76, 175, 80, 0.4);
        }

        .btn-clear {
            background: #f44336;
            color: white;
        }

        .btn-clear:hover {
            background: #da190b;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(244, 67, 54, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .info-box {
            background: #f5f7fa;
            border-left: 4px solid #667eea;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .info-box p {
            font-size: 14px;
            color: #555;
            line-height: 1.8;
        }

        .info-box strong {
            color: #667eea;
        }

        .status {
            padding: 10px 15px;
            border-radius: 6px;
            font-size: 14px;
            margin-top: 10px;
            display: none;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.show {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .timestamp-info {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 10px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 8px;
            font-size: 13px;
        }

        .timestamp-info > div:not(.interval-config) {
            display: flex;
            flex-direction: column;
        }

        .timestamp-info label {
            color: #555;
            font-size: 13px;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .timestamp-info span {
            color: #333;
            font-weight: bold;
            font-family: 'Consolas', monospace;
        }

        .current-timestamp-box {
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .timestamp-display {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-copy-timestamp {
            padding: 2px 6px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 3px;
            font-size: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .btn-copy-timestamp:hover {
            background: #45a049;
            transform: scale(1.05);
            box-shadow: 0 2px 6px rgba(76, 175, 80, 0.3);
        }

        .btn-copy-timestamp:active {
            transform: scale(0.98);
        }

        .interval-config {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 10px;
            width: 200px;
        }

        .interval-config label {
            color: #555;
            font-size: 13px;
            margin-bottom: 0;
            font-weight: 600;
            white-space: nowrap;
        }

        .interval-config input {
            width: 100px;
            padding: 6px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 13px;
            font-family: 'Consolas', monospace;
            text-align: center;
            transition: border-color 0.3s;
        }

        .interval-config input:focus {
            outline: none;
            border-color: #667eea;
        }

        .start-time-config {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: fit-content;
        }

        .start-time-label-row {
            display: flex;
            align-items: center;
            gap: 12px;
            width: fit-content;
        }

        .start-time-config > .start-time-label-row > label {
            color: #555;
            font-size: 13px;
            font-weight: 600;
            white-space: nowrap;
        }

        .start-time-row {
            display: flex;
            align-items: center;
            gap: 12px;
            width: fit-content;
        }

        .start-time-config input[type="datetime-local"] {
            padding: 8px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            font-family: 'Consolas', monospace;
            transition: border-color 0.3s;
            width: 225px;
            text-align: left;
        }

        .start-time-config input[type="datetime-local"]:focus {
            outline: none;
            border-color: #667eea;
        }

        .use-current-time {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 3px 8px;
            background: #f5f7fa;
            border-radius: 4px;
            border: 1px solid #d0d0d0;
        }

        .use-current-time input[type="checkbox"] {
            width: 16px;
            height: 16px;
            margin: 0;
            cursor: pointer;
        }

        .use-current-time label {
            margin: 0;
            cursor: pointer;
            font-size: 12px;
            color: #555;
            font-weight: 500;
            white-space: nowrap;
            line-height: 20px;
        }

        .btn-copy-converter {
            width: auto;
            padding: 6px 12px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 8px;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .btn-copy-converter:hover {
            background: #45a049;
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
        }

        .btn-copy-converter:active {
            transform: scale(0.98);
        }

        .timestamp-section {
            background: #e8f5e9;
            border: 2px dashed #4caf50;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .timestamp-header {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
        }

        .timestamp-title {
            font-size: 22px;
            font-weight: bold;
            color: #4caf50;
            text-align: center;
        }

        .btn-help {
            position: absolute;
            right: 0;
            padding: 6px 12px;
            background: white;
            color: #4caf50;
            border: 2px solid #4caf50;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .btn-help:hover {
            background: #4caf50;
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .help-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            margin-bottom: 0;
        }

        .help-content.show {
            max-height: 500px;
            margin-bottom: 20px;
        }

        .info-box {
            background: #f5f7fa;
            border-left: 4px solid #4caf50;
            padding: 15px 20px;
            border-radius: 8px;
        }

        .barcode-section {
            background: #fff8e1;
            border: 2px dashed #ffa726;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .barcode-title {
            font-size: 22px;
            font-weight: bold;
            color: #ffa726;
            margin-bottom: 15px;
            text-align: center;
        }

        .barcode-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .barcode-left {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .barcode-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .barcode-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            font-family: 'Consolas', monospace;
        }

        .barcode-input:focus {
            outline: none;
            border-color: #ffa726;
        }

        .code-type-switch {
            display: flex;
            background: #f5f5f5;
            border-radius: 6px;
            padding: 3px;
        }

        .code-type-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            color: #666;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.3s;
        }

        .code-type-btn.active {
            background: white;
            color: #ffa726;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .btn-generate {
            width: 100%;
            padding: 10px 20px;
            background: linear-gradient(135deg, #ffa726 0%, #fb8c00 100%);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-generate:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255, 167, 38, 0.3);
        }

        .code-display {
            background: white;
            padding: 30px;
            border-radius: 8px;
            text-align: center;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 1px solid #e0e0e0;
        }

        .code-display canvas,
        .code-display svg,
        .code-display #qrcodeContainer {
            margin: 20px auto;
        }

        .code-info {
            margin-top: 15px;
            font-size: 13px;
            color: #666;
        }

        .btn-download {
            margin-top: 15px;
            padding: 8px 16px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: none;
        }

        .btn-download:hover {
            background: #45a049;
            transform: translateY(-1px);
        }

        .unicode-section {
            background: #fce4ec;
            border: 2px dashed #e91e63;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .unicode-title {
            font-size: 22px;
            font-weight: bold;
            color: #e91e63;
            margin-bottom: 15px;
            text-align: center;
        }

        .unicode-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .unicode-box {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .unicode-label {
            font-size: 14px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .unicode-textarea {
            width: 100%;
            min-height: 120px;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 13px;
            font-family: 'Consolas', monospace;
            resize: vertical;
            transition: border-color 0.3s;
        }

        .unicode-textarea:focus {
            outline: none;
            border-color: #e91e63;
        }

        .unicode-textarea[readonly] {
            display: none;
        }

        .unicode-textarea[readonly].show {
            display: block;
        }

        .btn-unicode-convert {
            width: 100%;
            padding: 10px;
            background: linear-gradient(135deg, #e91e63 0%, #c2185b 100%);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .btn-unicode-convert:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(233, 30, 99, 0.3);
        }

        @media (max-width: 768px) {
            .unicode-grid {
                grid-template-columns: 1fr;
            }
        }

        .random-text-section {
            background: #fff3e0;
            border: 2px dashed #ff9800;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .random-text-title {
            font-size: 22px;
            font-weight: bold;
            color: #ff9800;
            margin-bottom: 15px;
            text-align: center;
        }

        .random-text-controls {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .control-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .control-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-item label {
            font-size: 13px;
            color: #555;
            font-weight: 600;
            white-space: nowrap;
        }

        .control-item input[type="number"],
        .control-item select {
            width: 120px;
            padding: 6px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 13px;
            transition: border-color 0.3s;
        }

        .control-item input[type="number"]:focus,
        .control-item select:focus {
            outline: none;
            border-color: #ff9800;
        }

        .char-types {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .char-type-checkbox {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            background: #f5f5f5;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .char-type-checkbox:hover {
            background: #ffecb3;
        }

        .char-type-checkbox input[type="checkbox"] {
            cursor: pointer;
        }

        .char-type-checkbox label {
            cursor: pointer;
            font-size: 12px;
            color: #555;
            margin: 0;
        }

        .btn-generate-text {
            padding: 8px 16px;
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 2px 5px rgba(255, 152, 0, 0.2);
            white-space: nowrap;
            max-width: 200px;
        }

        .btn-generate-text:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255, 152, 0, 0.3);
        }

        .random-text-output {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            display: none;
        }

        .random-text-output.show {
            display: block;
        }

        .random-text-result {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            font-family: 'Consolas', monospace;
            resize: vertical;
            background: #f9f9f9;
            color: #333;
            line-height: 1.6;
            word-break: break-all;
        }

        .random-text-info {
            margin-top: 10px;
            padding: 10px;
            background: #fff3e0;
            border-radius: 6px;
            font-size: 12px;
            color: #f57c00;
            display: none;
        }

        .random-text-info.show {
            display: block;
        }

        .barcode-status,
        .unicode-status,
        .random-text-status {
            padding: 10px 15px;
            border-radius: 6px;
            font-size: 14px;
            margin-top: 10px;
            display: none;
        }

        .barcode-status.success,
        .unicode-status.success,
        .random-text-status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .barcode-status.error,
        .unicode-status.error,
        .random-text-status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .barcode-status.show,
        .unicode-status.show,
        .random-text-status.show {
            display: block;
            animation: slideIn 0.3s ease;
        }

        .battery-section {
            background: #e3f2fd;
            border: 2px dashed #2196f3;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .battery-title {
            font-size: 22px;
            font-weight: bold;
            color: #2196f3;
            margin-bottom: 15px;
            text-align: center;
        }

        .battery-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .mqtt-input-section,
        .mqtt-output-section {
            margin-bottom: 15px;
        }

        .mqtt-textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            line-height: 1.6;
            resize: vertical;
            transition: border-color 0.3s;
        }

        .mqtt-textarea:focus {
            outline: none;
            border-color: #2196f3;
        }

        .mqtt-textarea[readonly] {
            background: #f9f9f9;
        }

        .battery-label {
            display: block;
            font-size: 14px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .battery-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .btn-battery-update,
        .btn-battery-copy,
        .btn-battery-clear {
            flex: 1;
            padding: 12px 20px;
            font-size: 14px;
            font-weight: bold;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .btn-battery-update {
            background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%);
            color: white;
        }

        .btn-battery-update:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3);
        }

        .btn-battery-copy {
            background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
            color: white;
        }

        .btn-battery-copy:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .btn-battery-clear {
            background: linear-gradient(135deg, #f44336 0%, #da190b 100%);
            color: white;
        }

        .btn-battery-clear:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(244, 67, 54, 0.3);
        }

        .battery-status {
            padding: 10px 15px;
            border-radius: 6px;
            font-size: 14px;
            margin-top: 10px;
            display: none;
        }

        .battery-status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .battery-status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .battery-status.show {
            display: block;
            animation: slideIn 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="main-wrapper">
    <!-- å·¦ä¾§èœå• -->
    <div class="sidebar">
        <div class="sidebar-title">ğŸ› ï¸ å·¥å…·å¯¼èˆª</div>
        <div class="menu-item active" onclick="scrollToSection('timestamp-section')">
            <span>â±ï¸</span>
            <span>æ—¶é—´æˆ³æ›´æ–°</span>
        </div>
        <div class="menu-item" onclick="scrollToSection('converter-section')">
            <span>ğŸ”„</span>
            <span>æ—¶é—´è½¬æ¢</span>
        </div>
        <div class="menu-item" onclick="scrollToSection('barcode-section')">
            <span>ğŸ“Š</span>
            <span>æ¡ç ç”Ÿæˆ</span>
        </div>
        <div class="menu-item" onclick="scrollToSection('random-text-section')">
            <span>ğŸ²</span>
            <span>éšæœºæ–‡å­—ç”Ÿæˆ</span>
        </div>
        <div class="menu-item" onclick="scrollToSection('unicode-section')">
            <span>ğŸ”¤</span>
            <span>Unicodeè½¬æ¢</span>
        </div>
        <div class="menu-item" onclick="scrollToSection('battery-section')">
            <span>ğŸ“¡</span>
            <span>MQTTæŠ¥æ–‡ç®¡ç†</span>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <h1><img src="cat.png" alt="çŒ«å’ªå›¾æ ‡" style="width: 32px; height: 32px; vertical-align: middle; margin-right: 8px; background: transparent; mix-blend-mode: multiply;"> å°å¤©æ‰å·¥å…·åŒ…</h1>
            <p>JSONæ—¶é—´æˆ³æ›´æ–°ã€æ—¶é—´è½¬æ¢ã€æ¡å½¢ç /äºŒç»´ç ç”Ÿæˆã€Unicodeè½¬æ¢ã€éšæœºæ–‡å­—ç”Ÿæˆ</p>
        </div>

        <div class="content">
            <!-- å®šä½æŠ¥æ–‡æ—¶é—´æˆ³æ›´æ–°å·¥å…· -->
            <div class="timestamp-section" id="timestamp-section">
                <div class="timestamp-header">
                    <div class="timestamp-title">â±ï¸ MQTTæŠ¥æ–‡æ—¶é—´æˆ³æ›´æ–°å·¥å…·</div>
                    <button class="btn-help" onclick="toggleHelp()">
                        <span id="helpIcon">ğŸ“–</span>
                        <span id="helpText">ä½¿ç”¨è¯´æ˜</span>
                    </button>
                </div>

                <div class="help-content" id="helpContent">
                    <div class="info-box">
                        <p><strong>ä½¿ç”¨è¯´æ˜ï¼š</strong></p>
                        <p>1ï¸âƒ£ å°†MQTTæŠ¥æ–‡JSONç²˜è´´åˆ°è¾“å…¥æ¡†</p>
                        <p>2ï¸âƒ£ å¯é€‰ï¼šè®¾ç½®"æŠ¥æ–‡é¦–ä¸ªtimestamp"ï¼ˆé»˜è®¤ä½¿ç”¨å½“å‰æ—¶é—´ï¼Œå–æ¶ˆå‹¾é€‰å¯è‡ªå®šä¹‰ï¼‰</p>
                        <p>3ï¸âƒ£ å¯é€‰ï¼šè°ƒæ•´"é€’å¢é—´éš”"ï¼ˆé»˜è®¤10ç§’ï¼‰</p>
                        <p>4ï¸âƒ£ ç‚¹å‡»"æ›´æ–°æ—¶é—´æˆ³"æŒ‰é’®</p>
                        <p>5ï¸âƒ£ ç¬¬ä¸€ä¸ªtimestampä½¿ç”¨èµ·å§‹æ—¶é—´ï¼Œåç»­æ¯ä¸ªé€’å¢è®¾å®šçš„é—´éš”ç§’æ•°</p>
                        <p>6ï¸âƒ£ ç‚¹å‡»"å¤åˆ¶ç»“æœ"å¯ç›´æ¥å¤åˆ¶åˆ°å‰ªè´´æ¿</p>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">è¾“å…¥åŸå§‹æŠ¥æ–‡</div>
                    <div class="json-tools">
                        <button class="btn-tool" onclick="restoreOriginal()">ğŸ”„ åŸå§‹æ ¼å¼</button>
                        <button class="btn-tool" onclick="formatJSON()">ğŸ“ JSONæ ¼å¼åŒ–</button>
                        <button class="btn-tool" onclick="compressJSON()">ğŸ—œï¸ å‹ç¼©</button>
                    </div>
                    <textarea id="inputText" placeholder='ç²˜è´´JSONæŠ¥æ–‡ï¼Œä¾‹å¦‚ï¼š{"locations":[{"timestamp":1751598600,...}]}'></textarea>
                    <div class="timestamp-info">
                        <div class="start-time-config">
                            <div class="start-time-label-row">
                                <label>æŠ¥æ–‡é¦–ä¸ªtimestamp</label>
                                <input type="datetime-local" id="startTimeInput" step="1" />
                                <div class="use-current-time">
                                    <input type="checkbox" id="useCurrentTime" checked />
                                    <label for="useCurrentTime">ä½¿ç”¨å½“å‰æ—¶é—´</label>
                                </div>
                            </div>
                        </div>
                        <div class="interval-config">
                            <label>é€’å¢é—´éš”(ç§’)</label>
                            <input type="number" id="intervalInput" value="10" min="1" max="3600" />
                        </div>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn-update" onclick="updateTimestamps()">ğŸ”„ æ›´æ–°æ—¶é—´æˆ³</button>
                    <button class="btn-copy" onclick="copyResult()">ğŸ“‹ å¤åˆ¶ç»“æœ</button>
                    <button class="btn-clear" onclick="clearAll()">ğŸ—‘ï¸ æ¸…ç©º</button>
                </div>

                <div id="status" class="status"></div>

                <div class="section output-section" style="display: none;">
                    <div class="section-title">è¾“å‡ºç»“æœ</div>
                    <div id="outputDisplay" class="output-display">æ›´æ–°åçš„JSONå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</div>
                    <textarea id="outputText" readonly placeholder="æ›´æ–°åçš„JSONå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
                </div>
            </div>

            <!-- æ—¶é—´è½¬æ¢å·¥å…· -->
            <div class="converter-section" id="converter-section">
                <div class="converter-title">ğŸ”„ æ—¶é—´è½¬æ¢å·¥å…·</div>

                <!-- å½“å‰æ—¶é—´æˆ³æ˜¾ç¤º + ç²¾åº¦é…ç½® -->
                <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 20px; display: flex; gap: 20px; justify-content: space-between; align-items: center; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);">
                    <div style="display: flex; gap: 30px; align-items: center;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <label style="color: #888; font-size: 12px;">å½“å‰æ—¶é—´æˆ³</label>
                            <span id="currentTimestamp" style="color: #333; font-weight: bold; font-family: 'Consolas', monospace;">-</span>
                            <button class="btn-copy-timestamp" onclick="copyCurrentTimestamp()">ğŸ“‹</button>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <label style="color: #888; font-size: 12px;">å¯è¯»æ—¶é—´</label>
                            <span id="currentTime" style="color: #333; font-weight: bold; font-family: 'Consolas', monospace; min-width: 200px;">-</span>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px; flex-shrink: 0;">
                        <label style="color: #555; font-size: 11px; font-weight: 600; white-space: nowrap;">ç²¾åº¦ï¼š</label>
                        <div class="code-type-switch" style="margin: 0; padding: 2px; white-space: nowrap;">
                            <button class="code-type-btn active" id="precisionSecondBtn" onclick="switchPrecision('second')" style="padding: 4px 12px; font-size: 11px;">ç§’</button>
                            <button class="code-type-btn" id="precisionMillisecondBtn" onclick="switchPrecision('millisecond')" style="padding: 4px 12px; font-size: 11px;">æ¯«ç§’</button>
                        </div>
                    </div>
                </div>
                <div class="converter-grid">
                    <!-- æ—¶é—´æˆ³è½¬æ—¥æœŸ -->
                    <div class="converter-box">
                        <div class="converter-label">æ—¶é—´æˆ³ â†’ æ—¥æœŸæ—¶é—´</div>
                        <input type="text" id="timestampInput" placeholder="è¾“å…¥æ—¶é—´æˆ³ï¼Œä¾‹å¦‚ï¼š1736232000" />
                        <button class="btn-convert" onclick="convertTimestampToDate()">è½¬æ¢ä¸ºæ—¥æœŸ</button>
                        <div class="converter-result" id="timestampResult">ç­‰å¾…è½¬æ¢...</div>
                    </div>

                    <!-- æ—¥æœŸè½¬æ—¶é—´æˆ³ -->
                    <div class="converter-box">
                        <div class="converter-label">æ—¥æœŸæ—¶é—´ â†’ æ—¶é—´æˆ³</div>
                        <input type="datetime-local" id="dateInput" step="1" />
                        <button class="btn-convert" onclick="convertDateToTimestamp()">è½¬æ¢ä¸ºæ—¶é—´æˆ³</button>
                        <div class="converter-result" id="dateResult">ç­‰å¾…è½¬æ¢...</div>
                        <div style="text-align: center;">
                            <button class="btn-copy-converter" id="copyDateResult" onclick="copyConverterResult('dateResult')" style="display: none;">
                                <span>ğŸ“‹</span>
                                <span>å¤åˆ¶æ—¶é—´æˆ³</span>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="converterStatus" class="converter-status"></div>
            </div>

            <!-- æ¡å½¢ç /äºŒç»´ç ç”Ÿæˆå·¥å…· -->
            <div class="barcode-section" id="barcode-section">
                <div class="barcode-title">ğŸ“Š æ¡å½¢ç /äºŒç»´ç ç”Ÿæˆå·¥å…·</div>
                <div class="barcode-content">
                    <div class="barcode-left">
                        <div class="barcode-controls">
                            <input type="text" id="codeInput" class="barcode-input" placeholder="è¾“å…¥æ•°å­—æˆ–æ–‡æœ¬ï¼Œä¾‹å¦‚ï¼š1234567890" />
                            <div class="code-type-switch">
                                <button class="code-type-btn active" id="barcodeBtn" onclick="switchCodeType('barcode')">æ¡å½¢ç </button>
                                <button class="code-type-btn" id="qrcodeBtn" onclick="switchCodeType('qrcode')">äºŒç»´ç </button>
                            </div>
                            <button class="btn-generate" onclick="generateCode()">ç”Ÿæˆ</button>
                        </div>
                    </div>
                    <div class="barcode-right">
                        <div class="code-display" id="codeDisplay">
                            <p style="color: #999;">è¾“å…¥å†…å®¹åç‚¹å‡»"ç”Ÿæˆ"æŒ‰é’®</p>
                        </div>
                        <button class="btn-download" id="downloadBtn" onclick="downloadCode()">ğŸ’¾ ä¸‹è½½å›¾ç‰‡</button>
                    </div>
                </div>
                <div id="barcodeStatus" class="barcode-status"></div>
            </div>

            <!-- éšæœºæ–‡å­—ç”Ÿæˆå™¨ -->
            <div class="random-text-section" id="random-text-section">
                <div class="random-text-title">ğŸ² éšæœºæ–‡å­—ç”Ÿæˆå™¨</div>

                <div class="random-text-controls">
                    <div class="control-row">
                        <div class="control-item">
                            <label>ç”Ÿæˆé•¿åº¦ï¼š</label>
                            <input type="number" id="textLength" value="100" min="1" max="10000" />
                        </div>
                        <div class="control-item">
                            <label>æ ¼å¼ï¼š</label>
                            <select id="outputFormat">
                                <option value="continuous">è¿ç»­</option>
                                <option value="space">ç©ºæ ¼åˆ†éš”</option>
                                <option value="comma">é€—å·åˆ†éš”</option>
                                <option value="newline">æ¢è¡Œåˆ†éš”</option>
                            </select>
                        </div>
                    </div>

                    <div class="control-row">
                        <label style="font-size: 13px; color: #555; font-weight: 600;">å­—ç¬¦ç±»å‹ï¼š</label>
                        <div class="char-types">
                            <div class="char-type-checkbox">
                                <input type="checkbox" id="includeNumbers" checked />
                                <label for="includeNumbers">æ•°å­— (0-9)</label>
                            </div>
                            <div class="char-type-checkbox">
                                <input type="checkbox" id="includeLowercase" checked />
                                <label for="includeLowercase">å°å†™å­—æ¯ (a-z)</label>
                            </div>
                            <div class="char-type-checkbox">
                                <input type="checkbox" id="includeUppercase" checked />
                                <label for="includeUppercase">å¤§å†™å­—æ¯ (A-Z)</label>
                            </div>
                            <div class="char-type-checkbox">
                                <input type="checkbox" id="includeSpecial" />
                                <label for="includeSpecial">ç‰¹æ®Šç¬¦å· (!@#$...)</label>
                            </div>
                            <div class="char-type-checkbox">
                                <input type="checkbox" id="includeChinese" />
                                <label for="includeChinese">å¸¸ç”¨æ±‰å­—</label>
                            </div>
                        </div>
                        <button class="btn-generate-text" onclick="generateRandomText()">ğŸ² ç”Ÿæˆéšæœºæ–‡å­—</button>
                    </div>
                </div>

                <div class="random-text-output" id="randomTextOutput">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <label style="font-size: 13px; font-weight: 600; color: #333;">ç”Ÿæˆç»“æœ</label>
                        <button onclick="copyRandomText()" style="padding: 5px 10px; background: #4caf50; color: white; border: none; border-radius: 4px; font-size: 12px; font-weight: 600; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 4px rgba(76, 175, 80, 0.2); white-space: nowrap; max-width: 200px;" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 3px 8px rgba(76, 175, 80, 0.3)'" onmouseout="this.style.transform=''; this.style.boxShadow='0 2px 4px rgba(76, 175, 80, 0.2)'">
                            ğŸ“‹ å¤åˆ¶ç»“æœ
                        </button>
                    </div>
                    <textarea id="randomTextResult" class="random-text-result" readonly placeholder="ç‚¹å‡»ç”ŸæˆæŒ‰é’®å¼€å§‹..."></textarea>
                    <div id="randomTextInfo" class="random-text-info"></div>
                </div>
                <div id="randomTextStatus" class="random-text-status"></div>
            </div>

            <!-- Unicode-ä¸­æ–‡è½¬æ¢å·¥å…· -->
            <div class="unicode-section" id="unicode-section">
                <div class="unicode-title">ğŸ”¤ Unicode-ä¸­æ–‡è½¬æ¢å·¥å…·</div>
                <div class="unicode-grid">
                    <!-- ä¸­æ–‡è½¬Unicode -->
                    <div class="unicode-box">
                        <div class="unicode-label">ä¸­æ–‡ â†’ Unicode</div>
                        <textarea id="chineseInput" class="unicode-textarea" placeholder="è¾“å…¥ä¸­æ–‡æ–‡æœ¬ï¼Œä¾‹å¦‚ï¼šä½ å¥½ä¸–ç•Œ"></textarea>
                        <button class="btn-unicode-convert" onclick="convertChineseToUnicode()">è½¬æ¢ä¸ºUnicode</button>
                        <textarea id="unicodeOutput" class="unicode-textarea" placeholder="Unicodeç¼–ç ç»“æœ" readonly></textarea>
                    </div>

                    <!-- Unicodeè½¬ä¸­æ–‡ -->
                    <div class="unicode-box">
                        <div class="unicode-label">Unicode â†’ ä¸­æ–‡</div>
                        <textarea id="unicodeInput" class="unicode-textarea" placeholder="è¾“å…¥Unicodeç¼–ç ï¼Œä¾‹å¦‚ï¼š\u4f60\u597d\u4e16\u754c"></textarea>
                        <button class="btn-unicode-convert" onclick="convertUnicodeToChinese()">è½¬æ¢ä¸ºä¸­æ–‡</button>
                        <textarea id="chineseOutput" class="unicode-textarea" placeholder="ä¸­æ–‡ç»“æœ" readonly></textarea>
                    </div>
                </div>
                <div id="unicodeStatus" class="unicode-status"></div>
            </div>

            <!-- MQTTæŠ¥æ–‡ç®¡ç†å·¥å…· -->
            <div class="battery-section" id="battery-section">
                <div class="battery-title">ğŸ“¡ MQTTæŠ¥æ–‡ç®¡ç†å·¥å…·</div>
                <div class="battery-content">
                    <!-- é¢„è®¾æŠ¥æ–‡åˆ—è¡¨ -->
                    <div class="mqtt-preset-section" style="margin-bottom: 20px;">
                        <label class="battery-label">ğŸ“‹ å¿«æ·æŠ¥æ–‡ç®¡ç†ï¼š</label>
                        <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);">
                            <!-- è®¾å¤‡ç”µé‡æŠ¥æ–‡ -->
                            <div style="display: flex; align-items: center; gap: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid #42a5f5;">
                                <div style="flex: 1;">
                                    <div style="font-size: 15px; font-weight: 600; color: #333; margin-bottom: 5px;">
                                        ğŸ”‹ è®¾å¤‡ç”µé‡æŠ¥æ–‡
                                    </div>
                                    <div style="font-size: 12px; color: #666;">
                                        Topic: stag/card/${sn}/status/pub
                                    </div>
                                </div>
                                <div style="display: flex; gap: 8px;">
                                    <button onclick="copyPresetMessage('battery')" style="padding: 8px 16px; background: linear-gradient(135deg, #4caf50 0%, #45a049 100%); color: white; border: none; border-radius: 6px; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 2px 8px rgba(76, 175, 80, 0.2); white-space: nowrap;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(76, 175, 80, 0.3)'" onmouseout="this.style.transform=''; this.style.boxShadow='0 2px 8px rgba(76, 175, 80, 0.2)'">
                                        ğŸ“‹ æ»¡ç”µæŠ¥æ–‡å¤åˆ¶
                                    </button>
                                    <button onclick="copyPresetMessage('lowBattery')" style="padding: 8px 16px; background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%); color: white; border: none; border-radius: 6px; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 2px 8px rgba(255, 107, 107, 0.2); white-space: nowrap;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(255, 107, 107, 0.3)'" onmouseout="this.style.transform=''; this.style.boxShadow='0 2px 8px rgba(255, 107, 107, 0.2)'">
                                        âš ï¸ ä½ç”µæŠ¥æ–‡å¤åˆ¶
                                    </button>
                                    <button onclick="viewPresetMessage('battery')" style="padding: 8px 16px; background: linear-gradient(135deg, #42a5f5 0%, #1976d2 100%); color: white; border: none; border-radius: 6px; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 2px 8px rgba(33, 150, 243, 0.2); white-space: nowrap;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(33, 150, 243, 0.3)'" onmouseout="this.style.transform=''; this.style.boxShadow='0 2px 8px rgba(33, 150, 243, 0.2)'">
                                        ğŸ‘ï¸ æŸ¥çœ‹è¯¦æƒ…
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- æŠ¥æ–‡è¯¦æƒ…å±•ç¤ºåŒºï¼ˆé»˜è®¤éšè—ï¼‰-->
                    <div id="mqttDetailSection" class="mqtt-detail-section" style="display: none; margin-bottom: 20px;">
                        <label class="battery-label">æŠ¥æ–‡è¯¦æƒ…ï¼ˆå¯ç¼–è¾‘ï¼‰ï¼š</label>
                        <div style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);">
                            <!-- Topicæ˜¾ç¤ºå’Œå¤åˆ¶ -->
                            <div style="margin-bottom: 15px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e0e0e0;">
                                <div style="display: flex; align-items: center; justify-content: space-between; gap: 10px;">
                                    <div style="flex: 1;">
                                        <label style="font-size: 12px; color: #666; margin-bottom: 5px; display: block;">Topicï¼ˆå¯ç¼–è¾‘ï¼‰:</label>
                                        <input type="text" id="mqttTopicDisplay" value="stag/card/${sn}/status/pub" style="font-family: 'Consolas', monospace; font-size: 13px; color: #333; background: white; padding: 6px 10px; border-radius: 4px; display: block; border: 1px solid #ddd; width: 100%; transition: border-color 0.3s;" onfocus="this.style.borderColor='#9c27b0'" onblur="this.style.borderColor='#ddd'" />
                                    </div>
                                    <button onclick="copyTopicOnly()" style="padding: 6px 12px; background: linear-gradient(135deg, #9c27b0 0%, #7b1fa2 100%); color: white; border: none; border-radius: 4px; font-size: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s; white-space: nowrap; height: fit-content;" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 3px 8px rgba(156, 39, 176, 0.3)'" onmouseout="this.style.transform=''; this.style.boxShadow=''">
                                        ğŸ“‹ å¤åˆ¶Topic
                                    </button>
                                </div>
                            </div>

                            <!-- JSONå†…å®¹ -->
                            <label style="font-size: 12px; color: #666; margin-bottom: 8px; display: block;">JSONå†…å®¹:</label>
                            <textarea id="mqttDetail" class="mqtt-textarea" style="background: white; min-height: 250px;"></textarea>

                            <div style="display: flex; gap: 10px; margin-top: 10px;">
                                <button onclick="copyDetailMessage()" style="flex: 1; padding: 8px 16px; background: linear-gradient(135deg, #4caf50 0%, #45a049 100%); color: white; border: none; border-radius: 6px; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.3s;">
                                    ğŸ“‹ å¤åˆ¶JSONï¼ˆæ›´æ–°æ—¶é—´æˆ³ï¼‰
                                </button>
                                <button onclick="closeDetailView()" style="flex: 1; padding: 8px 16px; background: #6c757d; color: white; border: none; border-radius: 6px; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.3s;">
                                    å…³é—­
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="batteryStatus" class="battery-status"></div>
            </div>
        </div>
    </div>
    </div>

    <script>
        // å…¨å±€ç²¾åº¦è®¾ç½®ï¼ˆé»˜è®¤ç§’çº§ï¼‰
        let currentPrecision = 'second'; // 'second' æˆ– 'millisecond'

        // åˆ‡æ¢æ—¶é—´ç²¾åº¦
        function switchPrecision(precision) {
            currentPrecision = precision;

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.getElementById('precisionSecondBtn').classList.remove('active');
            document.getElementById('precisionMillisecondBtn').classList.remove('active');
            document.getElementById(precision === 'second' ? 'precisionSecondBtn' : 'precisionMillisecondBtn').classList.add('active');

            // æ›´æ–°å½“å‰æ—¶é—´æ˜¾ç¤º
            updateCurrentTime();

            // æ›´æ–°å ä½ç¬¦æç¤º
            const timestampInput = document.getElementById('timestampInput');
            if (precision === 'second') {
                timestampInput.placeholder = 'è¾“å…¥æ—¶é—´æˆ³ï¼Œä¾‹å¦‚ï¼š1736232000';
            } else {
                timestampInput.placeholder = 'è¾“å…¥æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰ï¼Œä¾‹å¦‚ï¼š1736232000000';
            }

            // æ¸…ç©ºè½¬æ¢ç»“æœ
            document.getElementById('timestampResult').className = 'converter-result';
            document.getElementById('timestampResult').textContent = 'ç­‰å¾…è½¬æ¢...';
            document.getElementById('dateResult').className = 'converter-result';
            document.getElementById('dateResult').textContent = 'ç­‰å¾…è½¬æ¢...';
            document.getElementById('copyDateResult').style.display = 'none';
        }

        // å®æ—¶æ›´æ–°å½“å‰æ—¶é—´æˆ³
        function updateCurrentTime() {
            let now;
            if (currentPrecision === 'second') {
                now = Math.floor(Date.now() / 1000);
            } else {
                now = Date.now();
            }

            document.getElementById('currentTimestamp').textContent = now;

            const currentDate = new Date();
            let timeStr;
            if (currentPrecision === 'second') {
                timeStr = currentDate.toLocaleString('zh-CN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    hour12: false
                });
            } else {
                timeStr = currentDate.toLocaleString('zh-CN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    hour12: false
                }) + '.' + String(currentDate.getMilliseconds()).padStart(3, '0');
            }

            document.getElementById('currentTime').textContent = timeStr;
        }

        // æ¯ç§’æ›´æ–°æ—¶é—´æ˜¾ç¤º
        setInterval(updateCurrentTime, 1000);
        updateCurrentTime();

        // ä¿å­˜åŸå§‹è¾“å…¥
        let originalInput = '';

        // åˆå§‹åŒ–èµ·å§‹æ—¶é—´è¾“å…¥æ¡†
        function initStartTimeInput() {
            const startTimeInput = document.getElementById('startTimeInput');
            const useCurrentTime = document.getElementById('useCurrentTime');

            // è®¾ç½®åˆå§‹å€¼ä¸ºå½“å‰æ—¶é—´
            const now = new Date();
            const localISOTime = new Date(now.getTime() - now.getTimezoneOffset() * 60000)
                .toISOString()
                .slice(0, 19);
            startTimeInput.value = localISOTime;

            // ç›‘å¬å¤é€‰æ¡†å˜åŒ–
            useCurrentTime.addEventListener('change', function() {
                if (this.checked) {
                    // ä½¿ç”¨å½“å‰æ—¶é—´ï¼Œç¦ç”¨è¾“å…¥æ¡†
                    startTimeInput.disabled = true;
                    startTimeInput.style.opacity = '0.5';
                    const now = new Date();
                    const localISOTime = new Date(now.getTime() - now.getTimezoneOffset() * 60000)
                        .toISOString()
                        .slice(0, 19);
                    startTimeInput.value = localISOTime;
                } else {
                    // ä½¿ç”¨è‡ªå®šä¹‰æ—¶é—´ï¼Œå¯ç”¨è¾“å…¥æ¡†
                    startTimeInput.disabled = false;
                    startTimeInput.style.opacity = '1';
                }
            });

            // åˆå§‹çŠ¶æ€
            startTimeInput.disabled = true;
            startTimeInput.style.opacity = '0.5';
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.addEventListener('load', function() {
            initStartTimeInput();
        });

        // ç›‘å¬è¾“å…¥æ¡†ç²˜è´´äº‹ä»¶ï¼Œä¿å­˜åŸå§‹æ ¼å¼
        document.addEventListener('DOMContentLoaded', function() {
            const inputTextarea = document.getElementById('inputText');

            // ç²˜è´´æ—¶ä¿å­˜åŸå§‹æ ¼å¼
            inputTextarea.addEventListener('paste', function(e) {
                setTimeout(() => {
                    originalInput = inputTextarea.value;
                    console.log('å·²ä¿å­˜åŸå§‹æ ¼å¼');
                }, 50);
            });

            // é¦–æ¬¡æ‰‹åŠ¨è¾“å…¥ä¹Ÿä¿å­˜ï¼ˆä»…ä¿å­˜ä¸€æ¬¡ï¼‰
            let hasManualInput = false;
            inputTextarea.addEventListener('input', function(e) {
                if (!hasManualInput && inputTextarea.value.trim() && !originalInput) {
                    setTimeout(() => {
                        originalInput = inputTextarea.value;
                        hasManualInput = true;
                        console.log('å·²ä¿å­˜æ‰‹åŠ¨è¾“å…¥çš„åŸå§‹æ ¼å¼');
                    }, 500);
                }
            });
        });

        // æ—¶é—´æˆ³è½¬æ—¥æœŸæ—¶é—´
        function convertTimestampToDate() {
            const timestampInput = document.getElementById('timestampInput').value.trim();
            const resultDiv = document.getElementById('timestampResult');

            if (!timestampInput) {
                resultDiv.textContent = 'âŒ è¯·è¾“å…¥æ—¶é—´æˆ³';
                resultDiv.className = 'converter-result';
                return;
            }

            const timestamp = parseInt(timestampInput);
            if (isNaN(timestamp)) {
                resultDiv.textContent = 'âŒ æ—¶é—´æˆ³æ ¼å¼é”™è¯¯,è¯·è¾“å…¥çº¯æ•°å­—';
                resultDiv.className = 'converter-result show';
                return;
            }

            try {
                let date;
                if (currentPrecision === 'second') {
                    date = new Date(timestamp * 1000);
                } else {
                    date = new Date(timestamp);
                }

                // æ ¼å¼åŒ–ä¸ºä¸­æ–‡æ—¥æœŸæ—¶é—´
                let dateStr = date.toLocaleString('zh-CN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    hour12: false
                });

                // å¦‚æœæ˜¯æ¯«ç§’çº§ï¼Œæ·»åŠ æ¯«ç§’æ˜¾ç¤º
                if (currentPrecision === 'millisecond') {
                    dateStr += '.' + String(date.getMilliseconds()).padStart(3, '0');
                }

                // ISOæ ¼å¼
                let isoStr = date.toISOString().replace('T', ' ');
                if (currentPrecision === 'second') {
                    isoStr = isoStr.replace(/\.\d{3}Z$/, '');
                } else {
                    isoStr = isoStr.replace('Z', '');
                }

                resultDiv.innerHTML = `âœ… è½¬æ¢æˆåŠŸ<br>ğŸ“… ${dateStr}<br>ğŸŒ ${isoStr} (UTC)`;
                resultDiv.className = 'converter-result success show';
            } catch (error) {
                resultDiv.textContent = 'âŒ è½¬æ¢å¤±è´¥ï¼š' + error.message;
                resultDiv.className = 'converter-result show';
            }
        }

        // æ—¥æœŸæ—¶é—´è½¬æ—¶é—´æˆ³
        function convertDateToTimestamp() {
            const dateInput = document.getElementById('dateInput').value;
            const resultDiv = document.getElementById('dateResult');
            const copyBtn = document.getElementById('copyDateResult');

            if (!dateInput) {
                resultDiv.textContent = 'âŒ è¯·é€‰æ‹©æ—¥æœŸæ—¶é—´';
                resultDiv.className = 'converter-result show';
                copyBtn.style.display = 'none';
                return;
            }

            try {
                const date = new Date(dateInput);
                let timestamp;

                if (currentPrecision === 'second') {
                    timestamp = Math.floor(date.getTime() / 1000);
                } else {
                    timestamp = date.getTime();
                }

                // æ ¼å¼åŒ–æ˜¾ç¤º
                let dateStr = date.toLocaleString('zh-CN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    hour12: false
                });

                // å¦‚æœæ˜¯æ¯«ç§’çº§ï¼Œæ·»åŠ æ¯«ç§’æ˜¾ç¤º
                if (currentPrecision === 'millisecond') {
                    dateStr += '.' + String(date.getMilliseconds()).padStart(3, '0');
                }

                resultDiv.innerHTML = `âœ… è½¬æ¢æˆåŠŸ<br>â±ï¸ æ—¶é—´æˆ³ï¼š${timestamp}<br>ğŸ“… ${dateStr}`;
                resultDiv.className = 'converter-result success show';
                resultDiv.dataset.timestamp = timestamp; // ä¿å­˜æ—¶é—´æˆ³å€¼
                copyBtn.style.display = 'block'; // æ˜¾ç¤ºå¤åˆ¶æŒ‰é’®
            } catch (error) {
                resultDiv.textContent = 'âŒ è½¬æ¢å¤±è´¥ï¼š' + error.message;
                resultDiv.className = 'converter-result show';
                copyBtn.style.display = 'none';
            }
        }

        // å¤åˆ¶å½“å‰æ—¶é—´æˆ³
        function copyCurrentTimestamp() {
            const timestamp = document.getElementById('currentTimestamp').textContent;

            if (!timestamp || timestamp === '-') {
                showConverterStatus('âŒ æ—¶é—´æˆ³æœªå‡†å¤‡å¥½', false);
                return;
            }

            // åˆ›å»ºä¸´æ—¶textareaç”¨äºå¤åˆ¶
            const tempTextarea = document.createElement('textarea');
            tempTextarea.value = timestamp;
            tempTextarea.style.position = 'fixed';
            tempTextarea.style.left = '-9999px';
            document.body.appendChild(tempTextarea);
            tempTextarea.select();

            try {
                document.execCommand('copy');
                showConverterStatus('âœ… å½“å‰æ—¶é—´æˆ³å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼', true);
            } catch (error) {
                showConverterStatus('âŒ å¤åˆ¶å¤±è´¥', false);
            }

            document.body.removeChild(tempTextarea);
        }

        // å¤åˆ¶è½¬æ¢å™¨ç»“æœ
        function copyConverterResult(resultDivId) {
            const resultDiv = document.getElementById(resultDivId);
            const timestamp = resultDiv.dataset.timestamp;

            if (!timestamp) {
                showConverterStatus('âŒ æ²¡æœ‰å¯å¤åˆ¶çš„æ—¶é—´æˆ³', false);
                return;
            }

            // åˆ›å»ºä¸´æ—¶textareaç”¨äºå¤åˆ¶
            const tempTextarea = document.createElement('textarea');
            tempTextarea.value = timestamp;
            tempTextarea.style.position = 'fixed';
            tempTextarea.style.left = '-9999px';
            document.body.appendChild(tempTextarea);
            tempTextarea.select();

            try {
                document.execCommand('copy');
                showConverterStatus('âœ… æ—¶é—´æˆ³å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼', true);
            } catch (error) {
                showConverterStatus('âŒ å¤åˆ¶å¤±è´¥', false);
            }

            document.body.removeChild(tempTextarea);
        }

        // æ”¯æŒEnteré”®å¿«æ·è½¬æ¢
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('timestampInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    convertTimestampToDate();
                }
            });

            document.getElementById('dateInput').addEventListener('change', function() {
                convertDateToTimestamp();
            });

            // åˆå§‹åŒ–æ—¥æœŸé€‰æ‹©å™¨ä¸ºå½“å‰æ—¶é—´
            const now = new Date();
            const localISOTime = new Date(now.getTime() - now.getTimezoneOffset() * 60000)
                .toISOString()
                .slice(0, 19);
            document.getElementById('dateInput').value = localISOTime;
        });

        function showStatus(message, isSuccess) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = 'status ' + (isSuccess ? 'success' : 'error') + ' show';

            setTimeout(() => {
                statusDiv.classList.remove('show');
            }, 3000);
        }

        function showConverterStatus(message, isSuccess) {
            const statusDiv = document.getElementById('converterStatus');
            statusDiv.textContent = message;
            statusDiv.className = 'converter-status ' + (isSuccess ? 'success' : 'error') + ' show';

            setTimeout(() => {
                statusDiv.classList.remove('show');
            }, 3000);
        }

        function showBarcodeStatus(message, isSuccess) {
            const statusDiv = document.getElementById('barcodeStatus');
            statusDiv.textContent = message;
            statusDiv.className = 'barcode-status ' + (isSuccess ? 'success' : 'error') + ' show';

            setTimeout(() => {
                statusDiv.classList.remove('show');
            }, 3000);
        }

        function showUnicodeStatus(message, isSuccess) {
            const statusDiv = document.getElementById('unicodeStatus');
            statusDiv.textContent = message;
            statusDiv.className = 'unicode-status ' + (isSuccess ? 'success' : 'error') + ' show';

            setTimeout(() => {
                statusDiv.classList.remove('show');
            }, 3000);
        }

        function showRandomTextStatus(message, isSuccess) {
            const statusDiv = document.getElementById('randomTextStatus');
            statusDiv.textContent = message;
            statusDiv.className = 'random-text-status ' + (isSuccess ? 'success' : 'error') + ' show';

            setTimeout(() => {
                statusDiv.classList.remove('show');
            }, 3000);
        }

        function updateTimestamps() {
            const input = document.getElementById('inputText').value;

            if (!input.trim()) {
                showStatus('âŒ è¯·å…ˆè¾“å…¥JSONæŠ¥æ–‡æ•°æ®', false);
                return;
            }

            // è·å–é€’å¢é—´éš”é…ç½®
            const intervalInput = document.getElementById('intervalInput');
            let interval = parseInt(intervalInput.value);

            // éªŒè¯é—´éš”å€¼
            if (isNaN(interval) || interval < 1 || interval > 3600) {
                showStatus('âŒ é€’å¢é—´éš”å¿…é¡»åœ¨1-3600ç§’ä¹‹é—´', false);
                intervalInput.value = 10; // é‡ç½®ä¸ºé»˜è®¤å€¼
                return;
            }

            // è·å–èµ·å§‹æ—¶é—´æˆ³
            let startTimestamp;
            const useCurrentTime = document.getElementById('useCurrentTime').checked;

            if (useCurrentTime) {
                // ä½¿ç”¨å½“å‰æ—¶é—´
                startTimestamp = Math.floor(Date.now() / 1000);
            } else {
                // ä½¿ç”¨è‡ªå®šä¹‰æ—¶é—´
                const startTimeInput = document.getElementById('startTimeInput').value;
                if (!startTimeInput) {
                    showStatus('âŒ è¯·é€‰æ‹©èµ·å§‹æ—¶é—´', false);
                    return;
                }

                const startDate = new Date(startTimeInput);
                if (isNaN(startDate.getTime())) {
                    showStatus('âŒ èµ·å§‹æ—¶é—´æ ¼å¼é”™è¯¯', false);
                    return;
                }

                startTimestamp = Math.floor(startDate.getTime() / 1000);
            }

            try {
                // è§£æJSONéªŒè¯æ ¼å¼
                const data = JSON.parse(input);

                // ä½¿ç”¨æ­£åˆ™æ›¿æ¢æ–¹å¼ç›´æ¥æ›¿æ¢timestampå€¼ï¼Œå®Œå…¨ä¿æŒåŸå§‹æ ¼å¼
                let output = input;
                let timestampCount = 0;

                // åŒ¹é… "timestamp":æ•°å­— æˆ– "timestamp": æ•°å­— çš„æ¨¡å¼
                output = output.replace(/"timestamp"\s*:\s*(\d+)/g, function(match) {
                    const newTimestamp = startTimestamp + (timestampCount * interval);
                    timestampCount++;
                    // ä¿æŒåŸå§‹çš„ç©ºæ ¼æ ¼å¼
                    if (match.includes(': ')) {
                        return `"timestamp": ${newTimestamp}`;
                    } else {
                        return `"timestamp":${newTimestamp}`;
                    }
                });

                // éšè—çš„textareaç”¨äºå¤åˆ¶
                document.getElementById('outputText').value = output;

                // é«˜äº®æ˜¾ç¤ºtimestampï¼ˆä¿æŒæ‰€æœ‰æ ¼å¼ï¼‰
                const highlightedOutput = output
                    .replace(/&/g, '&amp;')
                    .replace(/</g, '&lt;')
                    .replace(/>/g, '&gt;')
                    .replace(/"timestamp"\s*:\s*(\d+)/g, function(match, number) {
                        if (match.includes(': ')) {
                            return `"timestamp": <span class="highlight-timestamp">${number}</span>`;
                        } else {
                            return `"timestamp":<span class="highlight-timestamp">${number}</span>`;
                        }
                    });

                document.getElementById('outputDisplay').innerHTML = highlightedOutput;

                // æ˜¾ç¤ºè¾“å‡ºç»“æœåŒºåŸŸ
                document.querySelector('.output-section').style.display = 'block';

                // æ ¼å¼åŒ–èµ·å§‹æ—¶é—´æ˜¾ç¤º
                const startDate = new Date(startTimestamp * 1000);
                const startTimeStr = startDate.toLocaleString('zh-CN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    hour12: false
                });

                showStatus(`âœ… æˆåŠŸæ›´æ–° ${timestampCount} ä¸ªæ—¶é—´æˆ³ï¼èµ·å§‹æ—¶é—´ï¼š${startTimeStr}(${startTimestamp})ï¼Œé—´éš”ï¼š${interval}ç§’`, true);

            } catch (error) {
                showStatus('âŒ JSONæ ¼å¼é”™è¯¯ï¼š' + error.message, false);
            }
        }

        // æ£€æµ‹JSONç¼©è¿›
        function detectIndent(jsonStr) {
            const lines = jsonStr.split('\n');
            for (let line of lines) {
                const match = line.match(/^(\s+)/);
                if (match) {
                    return match[1].length;
                }
            }
            return 2; // é»˜è®¤2ä¸ªç©ºæ ¼
        }

        // JSONæ ¼å¼åŒ–
        function formatJSON() {
            const input = document.getElementById('inputText').value;
            if (!input.trim()) {
                showStatus('âŒ è¯·å…ˆè¾“å…¥JSONæ•°æ®', false);
                return;
            }

            try {
                const data = JSON.parse(input);
                const formatted = JSON.stringify(data, null, 2);
                document.getElementById('inputText').value = formatted;
                showStatus('âœ… JSONæ ¼å¼åŒ–æˆåŠŸï¼', true);
            } catch (error) {
                showStatus('âŒ JSONæ ¼å¼é”™è¯¯ï¼š' + error.message, false);
            }
        }

        // JSONå‹ç¼©
        function compressJSON() {
            const input = document.getElementById('inputText').value;
            if (!input.trim()) {
                showStatus('âŒ è¯·å…ˆè¾“å…¥JSONæ•°æ®', false);
                return;
            }

            try {
                const data = JSON.parse(input);
                const compressed = JSON.stringify(data);
                document.getElementById('inputText').value = compressed;
                showStatus('âœ… JSONå‹ç¼©æˆåŠŸï¼', true);
            } catch (error) {
                showStatus('âŒ JSONæ ¼å¼é”™è¯¯ï¼š' + error.message, false);
            }
        }

        // æ¢å¤åŸå§‹æ ¼å¼
        function restoreOriginal() {
            const inputTextarea = document.getElementById('inputText');

            if (!originalInput) {
                showStatus('âš ï¸ æ²¡æœ‰ä¿å­˜çš„åŸå§‹æ ¼å¼', false);
                return;
            }

            inputTextarea.value = originalInput;
            showStatus('âœ… å·²æ¢å¤åŸå§‹æ ¼å¼ï¼', true);
        }

        function copyResult() {
            const output = document.getElementById('outputText');

            if (!output.value) {
                showStatus('âŒ æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹', false);
                return;
            }

            // åˆ›å»ºä¸´æ—¶textareaç”¨äºå¤åˆ¶
            const tempTextarea = document.createElement('textarea');
            tempTextarea.value = output.value;
            tempTextarea.style.position = 'fixed';
            tempTextarea.style.left = '-9999px';
            document.body.appendChild(tempTextarea);
            tempTextarea.select();

            try {
                document.execCommand('copy');
                showStatus('âœ… å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼', true);
            } catch (error) {
                showStatus('âŒ å¤åˆ¶å¤±è´¥', false);
            }

            document.body.removeChild(tempTextarea);
        }

        function clearAll() {
            document.getElementById('inputText').value = '';
            document.getElementById('outputText').value = '';
            document.getElementById('outputDisplay').innerHTML = 'æ›´æ–°åçš„JSONå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...';
            originalInput = ''; // æ¸…ç©ºæ—¶ä¹Ÿæ¸…é™¤ä¿å­˜çš„åŸå§‹æ ¼å¼
            // éšè—è¾“å‡ºç»“æœåŒºåŸŸ
            document.querySelector('.output-section').style.display = 'none';
            showStatus('âœ… å·²æ¸…ç©ºæ‰€æœ‰å†…å®¹', true);
        }

        // æ”¯æŒå¿«æ·é”®
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + Enter æ›´æ–°æ—¶é—´æˆ³
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                updateTimestamps();
            }
            // Ctrl/Cmd + Shift + C å¤åˆ¶ç»“æœ
            if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'C') {
                e.preventDefault();
                copyResult();
            }
        });

        // ==================== æ¡å½¢ç /äºŒç»´ç åŠŸèƒ½ ====================
        let currentCodeType = 'barcode'; // é»˜è®¤ä¸ºæ¡å½¢ç 
        let generatedCanvas = null; // ä¿å­˜ç”Ÿæˆçš„canvasç”¨äºä¸‹è½½

        // åˆ‡æ¢ç ç±»å‹
        function switchCodeType(type) {
            currentCodeType = type;

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.getElementById('barcodeBtn').classList.remove('active');
            document.getElementById('qrcodeBtn').classList.remove('active');
            document.getElementById(type + 'Btn').classList.add('active');

            // æ¸…ç©ºæ˜¾ç¤ºåŒºåŸŸ
            const codeDisplay = document.getElementById('codeDisplay');
            codeDisplay.innerHTML = '<p style="color: #999;">è¾“å…¥å†…å®¹åç‚¹å‡»"ç”Ÿæˆ"æŒ‰é’®</p>';
            document.getElementById('downloadBtn').style.display = 'none';
            generatedCanvas = null;
        }

        // ç”Ÿæˆç 
        function generateCode() {
            const input = document.getElementById('codeInput').value.trim();
            const codeDisplay = document.getElementById('codeDisplay');
            const downloadBtn = document.getElementById('downloadBtn');

            if (!input) {
                showBarcodeStatus('âŒ è¯·è¾“å…¥è¦ç”Ÿæˆçš„å†…å®¹', false);
                return;
            }

            // æ¸…ç©ºæ˜¾ç¤ºåŒºåŸŸ
            codeDisplay.innerHTML = '';
            downloadBtn.style.display = 'none';
            generatedCanvas = null;

            try {
                if (currentCodeType === 'barcode') {
                    // ç”Ÿæˆæ¡å½¢ç 
                    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                    svg.id = 'barcodeSvg';
                    codeDisplay.appendChild(svg);

                    JsBarcode(svg, input, {
                        format: 'CODE128',
                        width: 2,
                        height: 100,
                        displayValue: true,
                        fontSize: 14,
                        margin: 10
                    });

                    // è½¬æ¢SVGä¸ºCanvasç”¨äºä¸‹è½½
                    svgToCanvas(svg);

                    const info = document.createElement('div');
                    info.className = 'code-info';
                    info.textContent = `æ¡å½¢ç å†…å®¹: ${input}`;
                    codeDisplay.appendChild(info);

                    showBarcodeStatus('âœ… æ¡å½¢ç ç”ŸæˆæˆåŠŸï¼', true);
                } else {
                    // ç”ŸæˆäºŒç»´ç 
                    const qrcodeContainer = document.createElement('div');
                    qrcodeContainer.id = 'qrcodeContainer';
                    codeDisplay.appendChild(qrcodeContainer);

                    new QRCode(qrcodeContainer, {
                        text: input,
                        width: 200,
                        height: 200,
                        colorDark: '#000000',
                        colorLight: '#ffffff',
                        correctLevel: QRCode.CorrectLevel.H
                    });

                    // è·å–ç”Ÿæˆçš„canvas
                    setTimeout(() => {
                        generatedCanvas = qrcodeContainer.querySelector('canvas');
                        if (generatedCanvas) {
                            downloadBtn.style.display = 'block';
                        }
                    }, 100);

                    const info = document.createElement('div');
                    info.className = 'code-info';
                    info.textContent = `äºŒç»´ç å†…å®¹: ${input}`;
                    codeDisplay.appendChild(info);

                    showBarcodeStatus('âœ… äºŒç»´ç ç”ŸæˆæˆåŠŸï¼', true);
                }

                downloadBtn.style.display = 'block';
            } catch (error) {
                codeDisplay.innerHTML = `<p style="color: #f44336;">ç”Ÿæˆå¤±è´¥ï¼š${error.message}</p>`;
                showBarcodeStatus('âŒ ç”Ÿæˆå¤±è´¥ï¼š' + error.message, false);
            }
        }

        // SVGè½¬Canvasï¼ˆç”¨äºæ¡å½¢ç ä¸‹è½½ï¼‰
        function svgToCanvas(svg) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const svgData = new XMLSerializer().serializeToString(svg);
            const img = new Image();

            const svgBlob = new Blob([svgData], { type: 'image/svg+xml;charset=utf-8' });
            const url = URL.createObjectURL(svgBlob);

            img.onload = function() {
                canvas.width = img.width;
                canvas.height = img.height;
                ctx.fillStyle = 'white';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 0, 0);
                URL.revokeObjectURL(url);
                generatedCanvas = canvas;
            };

            img.src = url;
        }

        // ä¸‹è½½ç”Ÿæˆçš„ç 
        function downloadCode() {
            if (!generatedCanvas) {
                // å¦‚æœæ˜¯æ¡å½¢ç ï¼Œé‡æ–°è·å–SVGå¹¶è½¬æ¢
                const svg = document.getElementById('barcodeSvg');
                if (svg) {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    const svgData = new XMLSerializer().serializeToString(svg);
                    const img = new Image();

                    const svgBlob = new Blob([svgData], { type: 'image/svg+xml;charset=utf-8' });
                    const url = URL.createObjectURL(svgBlob);

                    img.onload = function() {
                        canvas.width = img.width;
                        canvas.height = img.height;
                        ctx.fillStyle = 'white';
                        ctx.fillRect(0, 0, canvas.width, canvas.height);
                        ctx.drawImage(img, 0, 0);
                        URL.revokeObjectURL(url);

                        // ä¸‹è½½
                        const link = document.createElement('a');
                        link.download = currentCodeType === 'barcode' ? 'barcode.png' : 'qrcode.png';
                        link.href = canvas.toDataURL('image/png');
                        link.click();

                        showBarcodeStatus('âœ… å›¾ç‰‡å·²ä¸‹è½½ï¼', true);
                    };

                    img.src = url;
                } else {
                    showBarcodeStatus('âŒ æ²¡æœ‰å¯ä¸‹è½½çš„å†…å®¹', false);
                }
                return;
            }

            // ç›´æ¥ä¸‹è½½canvas
            const link = document.createElement('a');
            link.download = currentCodeType === 'barcode' ? 'barcode.png' : 'qrcode.png';
            link.href = generatedCanvas.toDataURL('image/png');
            link.click();

            showBarcodeStatus('âœ… å›¾ç‰‡å·²ä¸‹è½½ï¼', true);
        }

        // æ”¯æŒEnteré”®ç”Ÿæˆ
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('codeInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    generateCode();
                }
            });
        });

        // åˆ‡æ¢ä½¿ç”¨è¯´æ˜æ˜¾ç¤º/éšè—
        function toggleHelp() {
            const helpContent = document.getElementById('helpContent');
            const helpIcon = document.getElementById('helpIcon');
            const helpText = document.getElementById('helpText');

            if (helpContent.classList.contains('show')) {
                helpContent.classList.remove('show');
                helpIcon.textContent = 'ğŸ“–';
                helpText.textContent = 'ä½¿ç”¨è¯´æ˜';
            } else {
                helpContent.classList.add('show');
                helpIcon.textContent = 'ğŸ“•';
                helpText.textContent = 'æ”¶èµ·è¯´æ˜';
            }
        }

        // æ»šåŠ¨åˆ°æŒ‡å®šå·¥å…·åŒºåŸŸ
        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });

                // æ›´æ–°èœå•æ¿€æ´»çŠ¶æ€
                document.querySelectorAll('.menu-item').forEach(item => {
                    item.classList.remove('active');
                });
                event.target.closest('.menu-item').classList.add('active');
            }
        }

        // ç›‘å¬æ»šåŠ¨äº‹ä»¶,è‡ªåŠ¨æ›´æ–°èœå•æ¿€æ´»çŠ¶æ€
        let scrollTimeout;

        // ==================== Unicodeè½¬æ¢åŠŸèƒ½ ====================
        // ä¸­æ–‡è½¬Unicode
        function convertChineseToUnicode() {
            const input = document.getElementById('chineseInput').value;
            const output = document.getElementById('unicodeOutput');

            if (!input.trim()) {
                showUnicodeStatus('âŒ è¯·è¾“å…¥ä¸­æ–‡æ–‡æœ¬', false);
                output.value = '';
                output.classList.remove('show');
                return;
            }

            try {
                let result = '';
                for (let i = 0; i < input.length; i++) {
                    const char = input[i];
                    // åˆ¤æ–­æ˜¯å¦ä¸ºä¸­æ–‡å­—ç¬¦æˆ–éœ€è¦è½¬æ¢çš„å­—ç¬¦
                    if (char.charCodeAt(0) > 127) {
                        // è½¬æ¢ä¸º\uXXXXæ ¼å¼
                        const unicode = char.charCodeAt(0).toString(16).toUpperCase().padStart(4, '0');
                        result += '\\u' + unicode;
                    } else {
                        // ASCIIå­—ç¬¦ä¿æŒåŸæ ·
                        result += char;
                    }
                }
                output.value = result;
                output.classList.add('show');
                showUnicodeStatus('âœ… è½¬æ¢æˆåŠŸï¼', true);
            } catch (error) {
                output.value = '';
                output.classList.remove('show');
                showUnicodeStatus('âŒ è½¬æ¢å¤±è´¥ï¼š' + error.message, false);
            }
        }

        // Unicodeè½¬ä¸­æ–‡
        function convertUnicodeToChinese() {
            const input = document.getElementById('unicodeInput').value;
            const output = document.getElementById('chineseOutput');

            if (!input.trim()) {
                showUnicodeStatus('âŒ è¯·è¾“å…¥Unicodeç¼–ç ', false);
                output.value = '';
                output.classList.remove('show');
                return;
            }

            try {
                // å¤„ç†\uXXXXæ ¼å¼çš„Unicodeç¼–ç 
                let result = input.replace(/\\u([0-9a-fA-F]{4})/g, function(match, hex) {
                    return String.fromCharCode(parseInt(hex, 16));
                });

                // å¤„ç†&#æ•°å­—;æ ¼å¼çš„HTMLå®ä½“
                result = result.replace(/&#(\d+);/g, function(match, dec) {
                    return String.fromCharCode(parseInt(dec, 10));
                });

                // å¤„ç†&#xåå…­è¿›åˆ¶;æ ¼å¼çš„HTMLå®ä½“
                result = result.replace(/&#x([0-9a-fA-F]+);/g, function(match, hex) {
                    return String.fromCharCode(parseInt(hex, 16));
                });

                output.value = result;
                output.classList.add('show');
                showUnicodeStatus('âœ… è½¬æ¢æˆåŠŸï¼', true);
            } catch (error) {
                output.value = '';
                output.classList.remove('show');
                showUnicodeStatus('âŒ è½¬æ¢å¤±è´¥ï¼š' + error.message, false);
            }
        }

        // ==================== éšæœºæ–‡å­—ç”Ÿæˆå™¨åŠŸèƒ½ ====================
        // å­—ç¬¦é›†å®šä¹‰
        const CHAR_SETS = {
            numbers: '0123456789',
            lowercase: 'abcdefghijklmnopqrstuvwxyz',
            uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
            special: '!@#$%^&*()_+-=[]{}|;:,.<>?',
            // å¸¸ç”¨æ±‰å­—ï¼ˆ3500ä¸ªå¸¸ç”¨å­—çš„ä¸€éƒ¨åˆ†ï¼‰
            chinese: 'çš„ä¸€æ˜¯åœ¨ä¸äº†æœ‰å’Œäººè¿™ä¸­å¤§ä¸ºä¸Šä¸ªå›½æˆ‘ä»¥è¦ä»–æ—¶æ¥ç”¨ä»¬ç”Ÿåˆ°ä½œåœ°äºå‡ºå°±åˆ†å¯¹æˆä¼šå¯ä¸»å‘å¹´åŠ¨åŒå·¥ä¹Ÿèƒ½ä¸‹è¿‡å­è¯´äº§ç§é¢è€Œæ–¹åå¤šå®šè¡Œå­¦æ³•æ‰€æ°‘å¾—ç»åä¸‰ä¹‹è¿›ç€ç­‰éƒ¨åº¦å®¶ç”µåŠ›é‡Œå¦‚æ°´åŒ–é«˜è‡ªäºŒç†èµ·å°ç‰©ç°å®åŠ é‡éƒ½ä¸¤ä½“åˆ¶æœºå½“ä½¿ç‚¹ä»ä¸šæœ¬å»æŠŠæ€§å¥½åº”å¼€å®ƒåˆè¿˜å› ç”±å…¶äº›ç„¶å‰å¤–å¤©æ”¿å››æ—¥é‚£ç¤¾ä¹‰äº‹å¹³å½¢ç›¸å…¨è¡¨é—´æ ·ä¸å…³å„é‡æ–°çº¿å†…æ•°æ­£å¿ƒåä½ æ˜çœ‹åŸåˆä¹ˆåˆ©æ¯”æˆ–ä½†è´¨æ°”ç¬¬å‘é“å‘½æ­¤å˜æ¡åªæ²¡ç»“è§£é—®æ„å»ºæœˆå…¬æ— ç³»å†›å¾ˆæƒ…è€…æœ€ç«‹ä»£æƒ³å·²é€šå¹¶æç›´é¢˜å…šç¨‹å±•äº”æœæ–™è±¡å‘˜é©ä½å…¥å¸¸æ–‡æ€»æ¬¡å“å¼æ´»è®¾åŠç®¡ç‰¹ä»¶é•¿æ±‚è€å¤´åŸºèµ„è¾¹æµè·¯çº§å°‘å›¾å±±ç»Ÿæ¥çŸ¥è¾ƒå°†ç»„è§è®¡åˆ«å¥¹æ‰‹è§’æœŸæ ¹è®ºè¿å†œæŒ‡å‡ ä¹åŒºå¼ºæ”¾å†³è¥¿è¢«å¹²åšå¿…æˆ˜å…ˆå›åˆ™ä»»å–æ®å¤„é˜Ÿå—ç»™è‰²å…‰é—¨å³ä¿æ²»åŒ—é€ ç™¾è§„çƒ­é¢†ä¸ƒæµ·å£ä¸œå¯¼å™¨å‹å¿—ä¸–é‡‘å¢äº‰æµé˜¶æ²¹æ€æœ¯æäº¤å—è”ä»€è®¤å…­å…±æƒæ”¶è¯æ”¹æ¸…å·±ç¾å†é‡‡è½¬æ›´å•é£åˆ‡æ‰“ç™½æ•™é€ŸèŠ±å¸¦å®‰åœºèº«è½¦ä¾‹çœŸåŠ¡å…·ä¸‡æ¯ç›®è‡³è¾¾èµ°ç§¯ç¤ºè®®å£°æŠ¥æ–—å®Œç±»å…«ç¦»ååç¡®æ‰ç§‘å¼ ä¿¡é©¬èŠ‚è¯ç±³æ•´ç©ºå…ƒå†µä»Šé›†æ¸©ä¼ åœŸè®¸æ­¥ç¾¤å¹¿çŸ³è®°éœ€æ®µç ”ç•Œæ‹‰æ—å¾‹å«ä¸”ç©¶è§‚è¶Šç»‡è£…å½±ç®—ä½æŒéŸ³ä¼—ä¹¦å¸ƒå¤å®¹å„¿é¡»é™…å•†ééªŒè¿æ–­æ·±éš¾è¿‘çŸ¿åƒå‘¨å§”ç´ æŠ€å¤‡åŠåŠé’çœåˆ—ä¹ å“çº¦æ”¯èˆ¬å²æ„ŸåŠ³ä¾¿å›¢å¾€é…¸å†å¸‚å…‹ä½•é™¤æ¶ˆæ„åºœç§°å¤ªå‡†ç²¾å€¼å·ç‡æ—ç»´åˆ’é€‰æ ‡å†™å­˜å€™æ¯›äº²å¿«æ•ˆæ–¯é™¢æŸ¥æ±Ÿå‹çœ¼ç‹æŒ‰æ ¼å…»æ˜“ç½®æ´¾å±‚ç‰‡å§‹å´ä¸“çŠ¶è‚²å‚äº¬è¯†é€‚å±åœ†åŒ…ç«ä½è°ƒæ»¡å¿å±€ç…§å‚çº¢ç»†å¼•å¬è¯¥é“ä»·ä¸¥é¾™é£'
        };

        // ç”Ÿæˆéšæœºæ–‡å­—
        function generateRandomText() {
            const length = parseInt(document.getElementById('textLength').value);
            const format = document.getElementById('outputFormat').value;

            // è·å–é€‰ä¸­çš„å­—ç¬¦ç±»å‹
            const includeNumbers = document.getElementById('includeNumbers').checked;
            const includeLowercase = document.getElementById('includeLowercase').checked;
            const includeUppercase = document.getElementById('includeUppercase').checked;
            const includeSpecial = document.getElementById('includeSpecial').checked;
            const includeChinese = document.getElementById('includeChinese').checked;

            // æ„å»ºå­—ç¬¦æ± 
            let charPool = '';
            if (includeNumbers) charPool += CHAR_SETS.numbers;
            if (includeLowercase) charPool += CHAR_SETS.lowercase;
            if (includeUppercase) charPool += CHAR_SETS.uppercase;
            if (includeSpecial) charPool += CHAR_SETS.special;
            if (includeChinese) charPool += CHAR_SETS.chinese;

            // éªŒè¯
            if (!charPool) {
                showRandomTextStatus('âŒ è¯·è‡³å°‘é€‰æ‹©ä¸€ç§å­—ç¬¦ç±»å‹', false);
                return;
            }

            if (isNaN(length) || length < 1 || length > 10000) {
                showRandomTextStatus('âŒ ç”Ÿæˆé•¿åº¦å¿…é¡»åœ¨1-10000ä¹‹é—´', false);
                return;
            }

            // ç”Ÿæˆéšæœºæ–‡å­—
            let result = '';
            for (let i = 0; i < length; i++) {
                const randomIndex = Math.floor(Math.random() * charPool.length);
                result += charPool[randomIndex];
            }

            // æ ¼å¼åŒ–è¾“å‡º
            let formattedResult = result;
            switch (format) {
                case 'space':
                    // æ¯10ä¸ªå­—ç¬¦åŠ ä¸€ä¸ªç©ºæ ¼
                    formattedResult = result.match(/.{1,10}/g).join(' ');
                    break;
                case 'comma':
                    // æ¯ä¸ªå­—ç¬¦ç”¨é€—å·åˆ†éš”
                    formattedResult = result.split('').join(',');
                    break;
                case 'newline':
                    // æ¯20ä¸ªå­—ç¬¦æ¢è¡Œ
                    formattedResult = result.match(/.{1,20}/g).join('\n');
                    break;
                case 'continuous':
                default:
                    // è¿ç»­è¾“å‡º
                    formattedResult = result;
                    break;
            }

            // æ˜¾ç¤ºç»“æœ
            document.getElementById('randomTextResult').value = formattedResult;

            // æ˜¾ç¤ºè¾“å‡ºåŒºåŸŸ
            document.getElementById('randomTextOutput').classList.add('show');

            // æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
            const info = document.getElementById('randomTextInfo');
            const actualLength = formattedResult.length;
            const charTypes = [];
            if (includeNumbers) charTypes.push('æ•°å­—');
            if (includeLowercase) charTypes.push('å°å†™å­—æ¯');
            if (includeUppercase) charTypes.push('å¤§å†™å­—æ¯');
            if (includeSpecial) charTypes.push('ç‰¹æ®Šç¬¦å·');
            if (includeChinese) charTypes.push('å¸¸ç”¨æ±‰å­—');

            info.innerHTML = `âœ… ç”ŸæˆæˆåŠŸï¼å­—ç¬¦ç±»å‹ï¼š${charTypes.join('ã€')} | åŸå§‹é•¿åº¦ï¼š${length} | æ ¼å¼åŒ–åé•¿åº¦ï¼š${actualLength}`;
            info.classList.add('show');

            showRandomTextStatus('âœ… éšæœºæ–‡å­—ç”ŸæˆæˆåŠŸï¼', true);
        }

        // å¤åˆ¶éšæœºæ–‡å­—ç»“æœ
        function copyRandomText() {
            const result = document.getElementById('randomTextResult').value;

            if (!result) {
                showRandomTextStatus('âŒ æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹', false);
                return;
            }

            // åˆ›å»ºä¸´æ—¶textareaç”¨äºå¤åˆ¶
            const tempTextarea = document.createElement('textarea');
            tempTextarea.value = result;
            tempTextarea.style.position = 'fixed';
            tempTextarea.style.left = '-9999px';
            document.body.appendChild(tempTextarea);
            tempTextarea.select();

            try {
                document.execCommand('copy');
                showRandomTextStatus('âœ… éšæœºæ–‡å­—å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼', true);
            } catch (error) {
                showRandomTextStatus('âŒ å¤åˆ¶å¤±è´¥', false);
            }

            document.body.removeChild(tempTextarea);
        }

        // ==================== MQTTæŠ¥æ–‡ç®¡ç†åŠŸèƒ½ ====================
        // é¢„è®¾æŠ¥æ–‡æ¨¡æ¿
        const MQTT_PRESETS = {
            battery: {
                name: 'è®¾å¤‡æ»¡ç”µæŠ¥æ–‡',
                topic: 'stag/card/${sn}/status/pub',
                payload: {
                    "timestamp": 1679645023,
                    "battery": 100,
                    "realBattery": 100,
                    "voltage": 3800,
                    "charger": 4,
                    "step": 6421,
                    "csq": 29
                },
                comments: {
                    "battery": "è™šæ‹Ÿç”µé‡ç™¾åˆ†æ¯”[0-100]",
                    "realBattery": "çœŸå®ç”µé‡ç™¾åˆ†æ¯”[0-100]",
                    "voltage": "ç”µå‹(mV)",
                    "charger": "å……ç”µçŠ¶æ€ã€‚0:æœªå……ç”µï¼Œ1:è„‰å†²å……(ç”µæ± æ¿€æ´»)ï¼Œ2:æ’æµå……ï¼Œ3:æ’å‹å……ï¼Œ4:å……ç”µåœæ­¢(å·²å……æ»¡)",
                    "step": "ä»Šæ—¥æ­¥æ•°",
                    "csq": "CSQä¿¡å·å¼ºåº¦"
                }
            },
            lowBattery: {
                name: 'è®¾å¤‡ä½ç”µé‡æŠ¥æ–‡',
                topic: 'stag/card/${sn}/status/pub',
                payload: {
                    "timestamp": 1679645023,
                    "battery": 1,
                    "realBattery": 1,
                    "voltage": 3800,
                    "charger": 0,
                    "step": 6421,
                    "csq": 29
                },
                comments: {
                    "battery": "è™šæ‹Ÿç”µé‡ç™¾åˆ†æ¯”[0-100]",
                    "realBattery": "çœŸå®ç”µé‡ç™¾åˆ†æ¯”[0-100]",
                    "voltage": "ç”µå‹(mV)",
                    "charger": "å……ç”µçŠ¶æ€ã€‚0:æœªå……ç”µï¼Œ1:è„‰å†²å……(ç”µæ± æ¿€æ´»)ï¼Œ2:æ’æµå……ï¼Œ3:æ’å‹å……ï¼Œ4:å……ç”µåœæ­¢(å·²å……æ»¡)",
                    "step": "ä»Šæ—¥æ­¥æ•°",
                    "csq": "CSQä¿¡å·å¼ºåº¦"
                }
            }
        };

        // æ„å»ºä¸å«æ³¨é‡Šçš„JSONå­—ç¬¦ä¸²
        function buildCleanJSON(payload) {
            const currentTimestamp = Math.floor(Date.now() / 1000);
            const updatedPayload = { ...payload, timestamp: currentTimestamp };
            return JSON.stringify(updatedPayload, null, 4);
        }

        // æ„å»ºå¸¦æ³¨é‡Šçš„JSONå­—ç¬¦ä¸²
        function buildCommentedJSON(payload, comments) {
            const currentTimestamp = Math.floor(Date.now() / 1000);
            let result = '{\n';
            const keys = Object.keys(payload);

            keys.forEach((key, index) => {
                const value = key === 'timestamp' ? currentTimestamp : payload[key];
                const comment = comments[key];

                // æ·»åŠ ç¼©è¿›å’Œé”®å€¼å¯¹
                result += `    "${key}": ${typeof value === 'string' ? '"' + value + '"' : value}`;

                // æœ€åä¸€é¡¹ä¸åŠ é€—å·ï¼Œå…¶ä»–é¡¹éœ€è¦åŠ é€—å·
                if (index < keys.length - 1) {
                    result += ',';
                }

                // æ·»åŠ æ³¨é‡Š
                if (comment) {
                    result += ` // ${comment}`;
                }

                // æ¢è¡Œ
                result += '\n';
            });
            result += '}';
            return result;
        }

        // å¤åˆ¶é¢„è®¾æŠ¥æ–‡ï¼ˆè‡ªåŠ¨æ›´æ–°æ—¶é—´æˆ³ï¼Œä¸å«æ³¨é‡Šï¼Œä¸å«Topicï¼‰
        function copyPresetMessage(presetKey) {
            const preset = MQTT_PRESETS[presetKey];
            if (!preset) {
                showBatteryStatus('âŒ æœªæ‰¾åˆ°é¢„è®¾æŠ¥æ–‡æ¨¡æ¿', false);
                return;
            }

            // åªæ„å»ºJSONéƒ¨åˆ†ï¼ˆä¸å«Topicï¼‰
            const message = buildCleanJSON(preset.payload);

            // åˆ›å»ºä¸´æ—¶textareaç”¨äºå¤åˆ¶
            const tempTextarea = document.createElement('textarea');
            tempTextarea.value = message;
            tempTextarea.style.position = 'fixed';
            tempTextarea.style.left = '-9999px';
            document.body.appendChild(tempTextarea);
            tempTextarea.select();

            try {
                document.execCommand('copy');
                const currentTimestamp = Math.floor(Date.now() / 1000);
                showBatteryStatus(`âœ… ${preset.name}å·²å¤åˆ¶ï¼æ—¶é—´æˆ³ï¼š${currentTimestamp}`, true);
            } catch (error) {
                showBatteryStatus('âŒ å¤åˆ¶å¤±è´¥ï¼š' + error.message, false);
            }

            document.body.removeChild(tempTextarea);
        }

        // æŸ¥çœ‹é¢„è®¾æŠ¥æ–‡è¯¦æƒ…ï¼ˆå«æ³¨é‡Šï¼Œå¯ç¼–è¾‘ï¼‰
        function viewPresetMessage(presetKey) {
            const preset = MQTT_PRESETS[presetKey];
            if (!preset) {
                showBatteryStatus('âŒ æœªæ‰¾åˆ°é¢„è®¾æŠ¥æ–‡æ¨¡æ¿', false);
                return;
            }

            // æ˜¾ç¤ºTopicï¼ˆä½¿ç”¨valueè€Œä¸æ˜¯textContentï¼‰
            document.getElementById('mqttTopicDisplay').value = preset.topic;

            // åªæ˜¾ç¤ºJSONéƒ¨åˆ†ï¼ˆå«æ³¨é‡Šï¼‰
            const jsonContent = buildCommentedJSON(preset.payload, preset.comments);
            document.getElementById('mqttDetail').value = jsonContent;
            document.getElementById('mqttDetailSection').style.display = 'block';

            // æ»šåŠ¨åˆ°è¯¦æƒ…åŒºåŸŸ
            document.getElementById('mqttDetailSection').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // å¤åˆ¶Topic
        function copyTopicOnly() {
            const topic = document.getElementById('mqttTopicDisplay').value.trim();

            if (!topic) {
                showBatteryStatus('âŒ Topicä¸ºç©º', false);
                return;
            }

            // åˆ›å»ºä¸´æ—¶textareaç”¨äºå¤åˆ¶
            const tempTextarea = document.createElement('textarea');
            tempTextarea.value = topic;
            tempTextarea.style.position = 'fixed';
            tempTextarea.style.left = '-9999px';
            document.body.appendChild(tempTextarea);
            tempTextarea.select();

            try {
                document.execCommand('copy');
                showBatteryStatus(`âœ… Topicå·²å¤åˆ¶ï¼š${topic}`, true);
            } catch (error) {
                showBatteryStatus('âŒ å¤åˆ¶å¤±è´¥ï¼š' + error.message, false);
            }

            document.body.removeChild(tempTextarea);
        }

        // å¤åˆ¶è¯¦æƒ…åŒºåŸŸçš„æŠ¥æ–‡ï¼ˆæ›´æ–°æ—¶é—´æˆ³åå¤åˆ¶ï¼‰
        function copyDetailMessage() {
            const detailContent = document.getElementById('mqttDetail').value.trim();

            if (!detailContent) {
                showBatteryStatus('âŒ æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹', false);
                return;
            }

            try {
                // ç›´æ¥å¤„ç†JSONå†…å®¹ï¼ˆä¸éœ€è¦è·³è¿‡Topicè¡Œï¼‰
                const jsonLines = detailContent.split('\n');

                // é€è¡Œæ¸…ç†æ³¨é‡Šï¼Œä¿ç•™æœ‰æ•ˆçš„JSONå†…å®¹
                const cleanedLines = [];
                for (let line of jsonLines) {
                    // æŸ¥æ‰¾æ³¨é‡Šçš„ä½ç½® //
                    const commentIndex = line.indexOf('//');

                    if (commentIndex !== -1) {
                        // å­˜åœ¨æ³¨é‡Šï¼Œæˆªå–æ³¨é‡Šå‰çš„éƒ¨åˆ†
                        let cleanLine = line.substring(0, commentIndex).trimEnd();

                        // å¦‚æœè¿™è¡Œåœ¨å»é™¤æ³¨é‡Šåè¿˜æœ‰å†…å®¹ï¼Œä¿ç•™å®ƒ
                        if (cleanLine.trim()) {
                            cleanedLines.push(cleanLine);
                        }
                    } else {
                        // ä¸å­˜åœ¨æ³¨é‡Šï¼Œä¿ç•™æ•´è¡Œ
                        cleanedLines.push(line);
                    }
                }

                // é‡æ–°ç»„åˆJSONå­—ç¬¦ä¸²
                const jsonContent = cleanedLines.join('\n');

                // è§£æJSON
                const data = JSON.parse(jsonContent);

                // æ›´æ–°æ—¶é—´æˆ³
                const currentTimestamp = Math.floor(Date.now() / 1000);
                data.timestamp = currentTimestamp;

                // æ ¼å¼åŒ–JSONï¼ˆä¸å«æ³¨é‡Šï¼‰
                const cleanJSON = JSON.stringify(data, null, 4);

                // åˆ›å»ºä¸´æ—¶textareaç”¨äºå¤åˆ¶
                const tempTextarea = document.createElement('textarea');
                tempTextarea.value = cleanJSON;
                tempTextarea.style.position = 'fixed';
                tempTextarea.style.left = '-9999px';
                document.body.appendChild(tempTextarea);
                tempTextarea.select();

                document.execCommand('copy');
                showBatteryStatus(`âœ… JSONå·²å¤åˆ¶ï¼æ—¶é—´æˆ³å·²æ›´æ–°ä¸ºï¼š${currentTimestamp}`, true);

                document.body.removeChild(tempTextarea);
            } catch (error) {
                console.error('è§£æé”™è¯¯:', error);
                console.error('åŸå§‹å†…å®¹:', detailContent);
                showBatteryStatus('âŒ å¤åˆ¶å¤±è´¥ï¼š' + error.message, false);
            }
        }

        // å…³é—­è¯¦æƒ…è§†å›¾
        function closeDetailView() {
            document.getElementById('mqttDetailSection').style.display = 'none';
        }

        // æ˜¾ç¤ºçŠ¶æ€æ¶ˆæ¯
        function showBatteryStatus(message, isSuccess) {
            const statusDiv = document.getElementById('batteryStatus');
            statusDiv.textContent = message;
            statusDiv.className = 'battery-status ' + (isSuccess ? 'success' : 'error') + ' show';

            setTimeout(() => {
                statusDiv.classList.remove('show');
            }, 3000);
        }

        // æ›´æ–°æ»šåŠ¨ç›‘å¬çš„sectionsåˆ—è¡¨
        window.addEventListener('scroll', function() {
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(function() {
                const sections = ['timestamp-section', 'converter-section', 'barcode-section', 'unicode-section', 'random-text-section', 'battery-section'];
                const menuItems = document.querySelectorAll('.menu-item');

                let currentSection = '';
                sections.forEach(sectionId => {
                    const section = document.getElementById(sectionId);
                    if (section) {
                        const rect = section.getBoundingClientRect();
                        // å¦‚æœåŒºåŸŸåœ¨è§†å£ä¸­é—´ä½ç½®é™„è¿‘
                        if (rect.top <= window.innerHeight / 2 && rect.bottom >= window.innerHeight / 2) {
                            currentSection = sectionId;
                        }
                    }
                });

                // å¦‚æœæ‰¾åˆ°å½“å‰åŒºåŸŸ,æ›´æ–°èœå•æ¿€æ´»çŠ¶æ€
                if (currentSection) {
                    menuItems.forEach((item, index) => {
                        item.classList.remove('active');
                        if (sections[index] === currentSection) {
                            item.classList.add('active');
                        }
                    });
                }
            }, 100);
        }, true);
    </script>
</body>
</html>
